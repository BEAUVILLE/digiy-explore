<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="DIGIY EXPLORE ‚Äî Saly & Petite C√¥te : plage, restos, culture, nature, activit√©s, h√©bergements. Carte + contact WhatsApp direct. 0% commission (mise en relation)." />
  <meta name="keywords" content="Saly, Petite C√¥te, S√©n√©gal, plage, restaurant, activit√©s, excursion, Somone, Ngaparou, Mbour, guide local" />
  <meta property="og:title" content="DIGIY EXPLORE ‚Äî Saly & Petite C√¥te" />
  <meta property="og:description" content="Carte + spots terrain + WhatsApp direct. DIGIY facilite la mise en relation." />
  <meta property="og:type" content="website" />

  <title>DIGIY EXPLORE ‚àû | Saly & Petite C√¥te</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet"/>

  <!-- Leaflet (Map) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{font-family:'Poppins',sans-serif;line-height:1.6;color:#111;background:#fff}
    a{text-decoration:none;color:inherit}
    img{max-width:100%;display:block}
    button,select,input{font-family:inherit}

    :root{
      --gold:#FFD700;
      --dark-gold:#DAA520;
      --orange:#FF6B35;
      --black:#000;
      --dark:#0b0f16;
      --dark2:#121826;
      --gray50:#f9fafb;
      --gray100:#f3f4f6;
      --gray200:#e5e7eb;
      --gray300:#d1d5db;
      --gray400:#9ca3af;
      --gray500:#6b7280;
      --gray700:#374151;
      --gray800:#1f2937;
      --green:#2ECC71;
      --white:#fff;
    }

    .container{width:100%;max-width:1200px;margin:0 auto;padding:0 16px}

    .text-gradient{
      background:linear-gradient(135deg,#FFD700 0%,#FFA500 100%);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    }

    .infinity-symbol{font-size:2rem;color:var(--gold);animation:pulse 2s infinite}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}
    @keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
    .animate-bounce{animation:bounce 2s infinite}

    header{
      position:fixed;top:0;left:0;right:0;z-index:50;
      background:rgba(0,0,0,.92);
      backdrop-filter:blur(10px);
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    header nav{padding:14px 0}
    .nav-links{display:flex;align-items:center;gap:22px}
    .nav-links a{color:#fff;font-weight:600;font-size:.95rem;opacity:.9}
    .nav-links a:hover{color:var(--gold);opacity:1}
    .nav-right{display:flex;align-items:center;gap:10px}

    .btn-outline{
      border:2px solid var(--gold);
      color:var(--gold);
      background:transparent;
      font-weight:700;
      padding:10px 16px;
      border-radius:999px;
      cursor:pointer;
      transition:all .2s ease;
      display:inline-flex;align-items:center;gap:8px;
      white-space:nowrap;
    }
    .btn-outline:hover{background:var(--gold);color:#000}

    .btn-primary{
      background:linear-gradient(135deg,#FFD700 0%,#FFA500 100%);
      color:#000;
      font-weight:800;
      padding:12px 18px;
      border-radius:999px;
      border:none;
      cursor:pointer;
      transition:all .2s ease;
      display:inline-flex;align-items:center;gap:8px;
      white-space:nowrap;
    }
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 10px 25px rgba(255,215,0,.35)}

    .hero{
      position:relative;
      min-height:92vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:url('https://images.unsplash.com/photo-1500375592092-40eb2168fd21?w=1600') center/cover;
    }
    .hero-overlay{
      position:absolute;inset:0;
      background:linear-gradient(135deg,rgba(0,0,0,.78) 0%, rgba(0,0,0,.45) 100%);
    }
    .hero-inner{position:relative;z-index:2;padding-top:90px;padding-bottom:36px;text-align:center;color:#fff}
    .hero h1{font-size:3.1rem;line-height:1.15;font-weight:900;margin-bottom:12px}
    .hero p{max-width:860px;margin:0 auto 10px;color:var(--gray200);font-size:1.1rem}
    .hero .subtitle{color:#facc15;font-weight:700;margin-top:8px}

    .hero-badges{
      margin-top:18px;
      display:flex;flex-wrap:wrap;justify-content:center;gap:10px;
      font-size:.9rem;
    }
    .badge{
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      padding:8px 12px;border-radius:999px;
      display:inline-flex;align-items:center;gap:8px;
      backdrop-filter:blur(6px);
    }
    .badge i{color:#4ade80}

    .filters{
      margin-top:22px;
      background:#fff;
      border-radius:18px;
      padding:14px;
      box-shadow:0 14px 36px rgba(0,0,0,.22);
      display:grid;
      grid-template-columns: 1.4fr 1fr 1fr 1fr 1fr;
      gap:10px;
      align-items:center;
      max-width:980px;
      margin-left:auto;margin-right:auto;
    }
    .filters input,.filters select{
      width:100%;
      border:1px solid var(--gray300);
      border-radius:12px;
      padding:11px 12px;
      font-size:.95rem;
      outline:none;
      background:#fff;
    }
    .filters input:focus,.filters select:focus{border-color:#facc15;box-shadow:0 0 0 3px rgba(250,204,21,.18)}
    .filters .btn-primary{width:100%;justify-content:center}

    @media (max-width: 900px){
      .hero h1{font-size:2.2rem}
      .filters{grid-template-columns:1fr;gap:10px}
    }

    section{padding:70px 0}
    .section-head{text-align:center;margin-bottom:24px}
    .section-head h2{font-size:2.2rem;font-weight:900}
    .section-head p{color:var(--gray600);max-width:860px;margin:8px auto 0}

    .map-wrap{
      background:linear-gradient(135deg, var(--dark) 0%, var(--dark2) 100%);
      color:#fff;
    }
    .map-card{
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      box-shadow:0 18px 46px rgba(0,0,0,.35);
      background:rgba(255,255,255,.04);
    }
    #map{height:360px;width:100%}
    .map-bar{
      display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;
      padding:14px 14px 16px;
    }
    .map-bar .hint{color:var(--gray200);font-size:.95rem}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(0,0,0,.25);
      color:#fff;font-weight:700;font-size:.9rem;
      white-space:nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(3, minmax(0, 1fr));
      gap:16px;
    }
    @media(max-width: 980px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media(max-width: 680px){ .grid{grid-template-columns:1fr} }

    .spot-card{
      border:1px solid rgba(17,24,39,.10);
      border-radius:18px;
      overflow:hidden;
      box-shadow:0 14px 30px rgba(15,23,42,.10);
      background:#fff;
      transition:transform .18s ease, box-shadow .18s ease;
      display:flex;flex-direction:column;
      min-height:100%;
    }
    .spot-card:hover{transform:translateY(-4px);box-shadow:0 20px 42px rgba(15,23,42,.18)}
    .spot-cover{height:170px;background:#111;position:relative}
    .spot-cover img{width:100%;height:100%;object-fit:cover}
    .tagline{
      position:absolute;left:12px;bottom:12px;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.14);
      color:#fff;
      padding:6px 10px;border-radius:999px;
      font-weight:800;font-size:.85rem;
      backdrop-filter:blur(6px);
    }
    .spot-body{padding:14px 14px 16px;display:flex;flex-direction:column;gap:10px;flex:1}
    .spot-title{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
    .spot-title h3{font-size:1.08rem;font-weight:900;color:#0b1220;line-height:1.2}
    .pill{
      font-size:.78rem;
      font-weight:900;
      padding:6px 10px;border-radius:999px;
      background:rgba(250,204,21,.25);
      color:#7c5200;
      border:1px solid rgba(250,204,21,.35);
      white-space:nowrap;
    }
    .spot-meta{display:flex;flex-wrap:wrap;gap:8px;color:var(--gray700);font-size:.88rem}
    .meta{
      display:inline-flex;align-items:center;gap:7px;
      padding:7px 10px;border-radius:999px;
      border:1px solid rgba(17,24,39,.10);
      background:var(--gray50);
      font-weight:700;
    }
    .spot-desc{color:var(--gray700);font-size:.95rem}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:auto}
    .btn-mini{
      padding:10px 12px;border-radius:999px;border:1px solid rgba(17,24,39,.12);
      font-weight:900;font-size:.9rem;
      display:inline-flex;align-items:center;gap:8px;
      cursor:pointer;white-space:nowrap;
      transition:.18s ease;
      background:#fff;
      color:#0b1220;
      flex:1;justify-content:center;
    }
    .btn-mini:hover{border-color:rgba(250,204,21,.65)}
    .btn-wa{
      background:linear-gradient(135deg,#2ECC71,#20c997);
      border:none;color:#062d1b;
    }
    .btn-wa:hover{filter:brightness(1.03);box-shadow:0 10px 24px rgba(46,204,113,.25)}
    .small-note{
      font-size:.85rem;color:var(--gray500);
      text-align:center;margin-top:14px;
    }

    footer{
      background:linear-gradient(135deg, var(--dark) 0%, #0a0f18 100%);
      color:#fff;
      padding:50px 0;
      border-top:1px solid rgba(255,255,255,.08);
    }
    footer .foot-grid{display:grid;grid-template-columns:1.4fr 1fr 1fr;gap:18px}
    @media(max-width:900px){footer .foot-grid{grid-template-columns:1fr}}
    .foot-title{font-weight:900;font-size:1.1rem;margin-bottom:10px;color:#facc15}
    .foot-txt{color:var(--gray200);font-size:.95rem}
    .foot-links a{display:block;color:var(--gray200);opacity:.85;margin:6px 0;font-weight:700}
    .foot-links a:hover{opacity:1;color:var(--gold)}
    .legal{margin-top:18px;color:var(--gray300);font-size:.85rem;opacity:.9}
  </style>
</head>

<body>

  <!-- HEADER -->
  <header>
    <nav class="container">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
        <div style="display:flex;align-items:center;gap:10px;">
          <span class="infinity-symbol">‚àû</span>
          <span style="font-size:1.25rem;font-weight:900;" class="text-gradient">DIGIY EXPLORE</span>
          <span style="color:#fff;opacity:.75;font-weight:700;font-size:.9rem;">Saly ‚Ä¢ Petite C√¥te</span>
        </div>

        <div class="nav-links" style="display:none;" id="navLinks">
          <a href="#carte">Carte</a>
          <a href="#spots">Spots</a>
          <a href="#contact">Contact</a>
        </div>

        <div class="nav-right">
          <a class="btn-outline" href="https://beauville.github.io/mon-espace-digiy/" target="_blank" rel="noopener">
            <i class="fa-solid fa-arrow-left"></i> HUB
          </a>
        </div>
      </div>
    </nav>
  </header>

  <!-- HERO -->
  <section class="hero" id="top">
    <div class="hero-overlay"></div>

    <div class="hero-inner container">
      <div style="font-size:3.2rem;font-weight:900;margin-bottom:6px;">üß≠</div>

      <h1>
        Saly & Petite C√¥te<br/>
        <span class="text-gradient">Plage ‚Ä¢ Resto ‚Ä¢ Culture ‚Ä¢ Nature</span>
      </h1>

      <p>
        Un site **terrain** : 6 spots propres, une carte, des filtres simples.
        Tu cliques, tu vois, tu √©cris sur WhatsApp.
        <strong style="color:#facc15;">DIGIY facilite la mise en relation</strong> (pas de promesse de r√©servation).
      </p>

      <p class="subtitle">üí¨ Contact direct ‚Ä¢ üìç Maps ‚Ä¢ üåç Carte interactive ‚Ä¢ 0% commission (mise en relation)</p>

      <div class="hero-badges">
        <div class="badge"><i class="fa-solid fa-check-circle"></i> Chill</div>
        <div class="badge"><i class="fa-solid fa-check-circle"></i> Famille</div>
        <div class="badge"><i class="fa-solid fa-check-circle"></i> Nightlife</div>
        <div class="badge"><i class="fa-solid fa-check-circle"></i> Romantique</div>
      </div>

      <!-- FILTERS -->
      <div class="filters" aria-label="Filtres DIGIY EXPLORE">
        <input id="q" type="text" placeholder="Recherche : plage, poisson, lagune, sunset..." />

        <select id="type">
          <option value="">Type (tous)</option>
          <option value="plage">Plage</option>
          <option value="resto">Resto</option>
          <option value="culture">Culture</option>
          <option value="nature">Nature</option>
          <option value="activit√©">Activit√©</option>
          <option value="h√©bergement">H√©bergement</option>
        </select>

        <select id="amb">
          <option value="">Ambiance (toutes)</option>
          <option value="chill">Chill</option>
          <option value="famille">Famille</option>
          <option value="nightlife">Nightlife</option>
          <option value="romantique">Romantique</option>
        </select>

        <select id="duree">
          <option value="">Dur√©e (toutes)</option>
          <option value="1h">1h</option>
          <option value="1/2 journ√©e">1/2 journ√©e</option>
          <option value="journ√©e">Journ√©e</option>
        </select>

        <select id="budget">
          <option value="">Budget (tous)</option>
          <option value="petit">Petit</option>
          <option value="moyen">Moyen</option>
          <option value="premium">Premium</option>
        </select>

        <button class="btn-primary" id="apply">
          <i class="fa-solid fa-magnifying-glass"></i> Filtrer
        </button>
      </div>

      <div style="margin-top:18px;opacity:.95">
        <a href="#carte" style="color:#fff;display:inline-flex;align-items:center;gap:8px;font-weight:800;">
          Descendre <i class="fa-solid fa-chevron-down animate-bounce"></i>
        </a>
      </div>
    </div>
  </section>

  <!-- MAP -->
  <section class="map-wrap" id="carte">
    <div class="container">
      <div class="section-head">
        <h2>Carte <span style="color:#facc15">interactive</span></h2>
        <p style="color:#e5e7eb;">Clique un spot sur la carte ‚Üí √ßa surligne la carte en bas. (Simple, terrain, efficace.)</p>
      </div>

      <div class="map-card">
        <div class="map-bar">
          <div class="hint">üìç Zone : <strong style="color:#facc15">Saly ‚Ä¢ Ngaparou ‚Ä¢ Somone ‚Ä¢ Mbour</strong></div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:flex-end;">
            <div class="chip"><i class="fa-solid fa-filter"></i> Filtres actifs : <span id="activeFilters">aucun</span></div>
            <a class="btn-outline" href="#spots" style="border-color:#fff;color:#fff;">
              <i class="fa-solid fa-list"></i> Voir les 6 cartes
            </a>
          </div>
        </div>
        <div id="map" aria-label="Carte DIGIY EXPLORE"></div>
      </div>

      <div class="small-note" style="color:#cbd5e1;">
        ‚úÖ Astuce : si tu veux un rendu ‚Äúpremium‚Äù, remplace les coordonn√©es + images par tes vrais partenaires terrain.
      </div>
    </div>
  </section>

  <!-- SPOTS -->
  <section id="spots">
    <div class="container">
      <div class="section-head">
        <h2>6 spots <span class="text-gradient">propres</span> (Saly / Petite C√¥te)</h2>
        <p>Filtre ‚Üí tu vois direct ce qui colle : type, ambiance, dur√©e, budget. Puis WhatsApp ou Maps.</p>
      </div>

      <div class="grid" id="spotsGrid"></div>

      <div class="small-note" id="countNote"></div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" style="background:var(--gray50);">
    <div class="container">
      <div class="section-head">
        <h2>Contact <span class="text-gradient">direct</span></h2>
        <p>Tu veux r√©f√©rencer ton spot / ton activit√© ? On te met propre : fiche, photos, map, WhatsApp.</p>
      </div>

      <div style="max-width:900px;margin:0 auto;background:#fff;border:1px solid rgba(17,24,39,.10);border-radius:18px;box-shadow:0 16px 36px rgba(15,23,42,.10);padding:18px;">
        <div style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;">
          <div>
            <div style="font-weight:900;font-size:1.1rem;margin-bottom:4px;">DIGIY EXPLORE ‚Äî √©quipe terrain</div>
            <div style="color:var(--gray700);font-weight:700;">WhatsApp : +221 77 134 28 89</div>
            <div style="color:var(--gray500);font-size:.92rem;margin-top:4px;">
              DIGIY facilite la mise en relation. Les prix/conditions se n√©gocient directement avec le pro.
            </div>
          </div>

          <a class="btn-primary" target="_blank" rel="noopener"
             href="https://wa.me/221771342889?text=Bonjour%20DIGIY%20EXPLORE,%20je%20veux%20r%C3%A9f%C3%A9rencer%20un%20spot%20sur%20Saly%20/%20Petite%20C%C3%B4te.%20Type:%20...%20Ambiance:%20...%20Budget:%20...">
            <i class="fa-brands fa-whatsapp"></i> √âcrire sur WhatsApp
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <div class="foot-grid">
        <div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <span style="font-size:2.1rem;">‚àû</span>
            <span class="text-gradient" style="font-size:1.3rem;font-weight:900;">DIGIY EXPLORE</span>
          </div>
          <div class="foot-txt">
            Site terrain : Saly & Petite C√¥te. Carte + spots + contact direct.<br/>
            <strong style="color:#facc15;">Objectif :</strong> visibilit√© + mise en relation, sans commission cach√©e.
          </div>
          <div class="legal">
            DIGIYLYFE facilite la mise en relation. V√©rifiez toujours infos, tarifs et conditions avant paiement.
          </div>
        </div>

        <div class="foot-links">
          <div class="foot-title">Navigation</div>
          <a href="#top">Accueil</a>
          <a href="#carte">Carte</a>
          <a href="#spots">Spots</a>
          <a href="#contact">Contact</a>
        </div>

        <div class="foot-links">
          <div class="foot-title">√âcosyst√®me</div>
          <a href="https://beauville.github.io/mon-espace-digiy/" target="_blank" rel="noopener">DIGIY HUB</a>
          <a href="#" title="√† brancher quand tu veux">DIGIY LOC</a>
          <a href="#" title="√† brancher quand tu veux">DIGIY DRIVER</a>
          <a href="#" title="√† brancher quand tu veux">DIGIY RESTO</a>
          <a href="#" title="√† brancher quand tu veux">DIGIY PAY</a>
        </div>
      </div>

      <div style="text-align:center;margin-top:22px;color:#facc15;font-weight:900;">
        ‚àû L‚ÄôAfrique enracin√©e, connect√©e au monde ‚àû
      </div>
    </div>
  </footer>

  <script>
    // =========================
    // DIGIY EXPLORE V2 (Saly)
    // =========================

    // ‚úÖ Num√©ro ‚Äúcentral‚Äù DIGIY (apporteur / mise en relation)
    const DIGIY_WA = "221771342889";

    // ‚úÖ 6 cartes propres (Saly / Petite C√¥te)
    // Note: remplace coords/nums/photos avec tes vrais partenaires terrain
    const SPOTS = [
      {
        id: "lagune-somone",
        title: "Lagune de Somone",
        tagline: "Nature ‚Ä¢ Chill",
        type: "nature",
        amb: ["chill","famille","romantique"],
        duree: "1/2 journ√©e",
        budget: "petit",
        zone: "Somone",
        lat: 14.487, lng: -17.075,
        img: "https://images.unsplash.com/photo-1500375592092-40eb2168fd21?w=1200",
        desc: "Balade douce, oiseaux, brise marine. Parfait pour respirer et faire de belles photos.",
      },
      {
        id: "plage-saly",
        title: "Plage de Saly (front de mer)",
        tagline: "Plage ‚Ä¢ Chill",
        type: "plage",
        amb: ["chill","famille","romantique"],
        duree: "1h",
        budget: "petit",
        zone: "Saly",
        lat: 14.444, lng: -17.007,
        img: "https://images.unsplash.com/photo-1519046904884-53103b34b206?w=1200",
        desc: "Simple et efficace : marche, baignade, coucher de soleil. Id√©al pour commencer le s√©jour.",
      },
      {
        id: "resto-poisson",
        title: "Resto Poisson (terrasse / local)",
        tagline: "Resto ‚Ä¢ Famille",
        type: "resto",
        amb: ["famille","chill"],
        duree: "1h",
        budget: "moyen",
        zone: "Ngaparou",
        lat: 14.468, lng: -17.060,
        img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=1200",
        desc: "Poisson grill√©, thieb, jus frais. Bon plan pour manger local sans se tromper.",
      },
      {
        id: "culture-artisanat",
        title: "March√© & Artisanat (Petite C√¥te)",
        tagline: "Culture ‚Ä¢ Local",
        type: "culture",
        amb: ["famille","chill"],
        duree: "1/2 journ√©e",
        budget: "petit",
        zone: "Mbour",
        lat: 14.420, lng: -16.965,
        img: "https://images.unsplash.com/photo-1523805009345-7448845a9e53?w=1200",
        desc: "Ambiance vraie : tissus, objets, souvenirs, √©changes. Le terrain, le vrai.",
      },
      {
        id: "quad-dunes",
        title: "Quad dunes & pistes",
        tagline: "Activit√© ‚Ä¢ Aventure",
        type: "activit√©",
        amb: ["chill","nightlife"],
        duree: "1h",
        budget: "moyen",
        zone: "Saly",
        lat: 14.452, lng: -17.030,
        img: "https://images.unsplash.com/photo-1601758260944-72f233eae2e0?w=1200",
        desc: "Sortie courte mais intense : dunes, pistes, sensations. Briefing s√©curit√© obligatoire.",
      },
      {
        id: "sunset-lounge",
        title: "Sunset Lounge (soir√©e / romantique)",
        tagline: "Resto ‚Ä¢ Nightlife",
        type: "resto",
        amb: ["nightlife","romantique"],
        duree: "1/2 journ√©e",
        budget: "premium",
        zone: "Saly",
        lat: 14.447, lng: -17.010,
        img: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=1200&q=80",
        desc: "Coucher de soleil + musique + ambiance. Bien pour date ou soir√©e entre amis.",
      }
    ];

    // ==========
    // MAP INIT
    // ==========
    const map = L.map('map', { scrollWheelZoom: false });
    // Centrage Saly (approx)
    map.setView([14.447, -17.010], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap'
    }).addTo(map);

    const markers = new Map();

    function popupHtml(s){
      return `
        <div style="font-family:Poppins,system-ui,sans-serif;">
          <div style="font-weight:900;margin-bottom:4px;">${escapeHtml(s.title)}</div>
          <div style="font-size:12px;opacity:.85;margin-bottom:8px;">${escapeHtml(s.zone)} ‚Ä¢ ${escapeHtml(s.type)} ‚Ä¢ ${escapeHtml(s.budget)}</div>
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <a target="_blank" rel="noopener"
               href="${waLink(s)}"
               style="background:#25D366;color:#062d1b;font-weight:900;padding:8px 10px;border-radius:999px;text-decoration:none;display:inline-flex;align-items:center;gap:6px;">
              WhatsApp
            </a>
            <a target="_blank" rel="noopener"
               href="${mapsLink(s)}"
               style="background:#111827;color:#fff;font-weight:900;padding:8px 10px;border-radius:999px;text-decoration:none;display:inline-flex;align-items:center;gap:6px;">
              Maps
            </a>
          </div>
        </div>
      `;
    }

    function buildMarkers(list){
      // Clear old markers
      for(const [id, m] of markers.entries()){
        map.removeLayer(m);
      }
      markers.clear();

      list.forEach(s => {
        const m = L.marker([s.lat, s.lng]).addTo(map);
        m.bindPopup(popupHtml(s));
        m.on('click', () => highlightCard(s.id));
        markers.set(s.id, m);
      });
    }

    // ==========
    // UI / GRID
    // ==========
    const grid = document.getElementById("spotsGrid");
    const note = document.getElementById("countNote");
    const activeFilters = document.getElementById("activeFilters");

    const $q = document.getElementById("q");
    const $type = document.getElementById("type");
    const $amb = document.getElementById("amb");
    const $duree = document.getElementById("duree");
    const $budget = document.getElementById("budget");
    const $apply = document.getElementById("apply");

    function waLink(s){
      const msg = encodeURIComponent(
        `Bonjour DIGIY EXPLORE, je veux infos sur : ${s.title} (${s.zone}). Type: ${s.type}. Ambiance: ${s.amb.join(", ")}. Dur√©e: ${s.duree}. Budget: ${s.budget}.`
      );
      return `https://wa.me/${DIGIY_WA}?text=${msg}`;
    }

    function mapsLink(s){
      return `https://www.google.com/maps?q=${encodeURIComponent(s.lat + "," + s.lng)}&z=16`;
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function cardHtml(s){
      return `
        <article class="spot-card" id="card-${escapeHtml(s.id)}" data-id="${escapeHtml(s.id)}">
          <div class="spot-cover">
            <img src="${escapeHtml(s.img)}" alt="${escapeHtml(s.title)}"/>
            <div class="tagline">${escapeHtml(s.tagline)}</div>
          </div>

          <div class="spot-body">
            <div class="spot-title">
              <h3>${escapeHtml(s.title)}</h3>
              <div class="pill">${escapeHtml(s.budget)}</div>
            </div>

            <div class="spot-meta">
              <div class="meta"><i class="fa-solid fa-location-dot"></i> ${escapeHtml(s.zone)}</div>
              <div class="meta"><i class="fa-solid fa-tag"></i> ${escapeHtml(s.type)}</div>
              <div class="meta"><i class="fa-regular fa-clock"></i> ${escapeHtml(s.duree)}</div>
            </div>

            <div class="spot-desc">${escapeHtml(s.desc)}</div>

            <div class="actions">
              <a class="btn-mini btn-wa" target="_blank" rel="noopener" href="${waLink(s)}">
                <i class="fa-brands fa-whatsapp"></i> WhatsApp
              </a>
              <a class="btn-mini" target="_blank" rel="noopener" href="${mapsLink(s)}">
                <i class="fa-solid fa-map-location-dot"></i> Maps
              </a>
            </div>
          </div>
        </article>
      `;
    }

    function render(list){
      grid.innerHTML = list.map(cardHtml).join("");
      note.textContent = `${list.length} spot(s) affich√©(s) sur 6 ‚Äî filtre terrain activ√©.`;
      buildMarkers(list);
    }

    function highlightCard(id){
      const el = document.getElementById(`card-${id}`);
      if(!el) return;
      el.scrollIntoView({behavior:"smooth", block:"center"});
      el.style.boxShadow = "0 20px 42px rgba(250,204,21,.35)";
      el.style.borderColor = "rgba(250,204,21,.65)";
      setTimeout(() => {
        el.style.boxShadow = "";
        el.style.borderColor = "";
      }, 1100);
    }

    function computeActiveLabel(f){
      const parts = [];
      if(f.q) parts.push(`q="${f.q}"`);
      if(f.type) parts.push(`type=${f.type}`);
      if(f.amb) parts.push(`amb=${f.amb}`);
      if(f.duree) parts.push(`dur√©e=${f.duree}`);
      if(f.budget) parts.push(`budget=${f.budget}`);
      return parts.length ? parts.join(" ‚Ä¢ ") : "aucun";
    }

    function applyFilters(){
      const f = {
        q: ($q.value || "").trim().toLowerCase(),
        type: $type.value,
        amb: $amb.value,
        duree: $duree.value,
        budget: $budget.value
      };

      activeFilters.textContent = computeActiveLabel(f);

      const out = SPOTS.filter(s => {
        if(f.type && s.type !== f.type) return false;
        if(f.amb && !s.amb.includes(f.amb)) return false;
        if(f.duree && s.duree !== f.duree) return false;
        if(f.budget && s.budget !== f.budget) return false;

        if(f.q){
          const hay = `${s.title} ${s.desc} ${s.zone} ${s.type} ${s.amb.join(" ")} ${s.tagline}`.toLowerCase();
          if(!hay.includes(f.q)) return false;
        }
        return true;
      });

      render(out);

      // recentre map sur le premier spot filtr√© si pr√©sent
      if(out.length){
        map.setView([out[0].lat, out[0].lng], 12);
      }
    }

    // UI events
    $apply.addEventListener("click", applyFilters);
    [$q,$type,$amb,$duree,$budget].forEach(el => {
      el.addEventListener("change", applyFilters);
    });
    $q.addEventListener("keydown", (e) => {
      if(e.key === "Enter") applyFilters();
    });

    // initial render
    render(SPOTS);
    activeFilters.textContent = "aucun";

    // Smooth scroll anchors (safe)
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', (e) => {
        const href = a.getAttribute("href");
        if(!href || href.length < 2) return;
        const target = document.querySelector(href);
        if(!target) return;
        e.preventDefault();
        target.scrollIntoView({behavior:"smooth", block:"start"});
      });
    });
  </script>
</body>
</html>
